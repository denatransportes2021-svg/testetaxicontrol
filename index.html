<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaxiControl Pro - Sistema de Gest√£o para Taxistas</title>


    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2d89ef, #1e3c72);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .auth-container {
            max-width: 450px;
            margin: 50px auto;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(15px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .logo {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .auth-title {
            font-size: 28px;
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin-bottom: 10px;
        }

        .auth-subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #ffcc00;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #ffcc00;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.3);
        }

        .auth-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #ffcc00, #ffd700);
            color: #000;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .auth-button:hover {
            background: linear-gradient(45deg, #e6b800, #ffcc00);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 204, 0, 0.4);
        }

        .auth-links {
            text-align: center;
            margin-top: 20px;
        }

        .auth-links a {
            color: #ffcc00;
            text-decoration: none;
            margin: 0 10px;
            font-weight: 500;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .auth-links a:hover {
            color: #ffd700;
            text-decoration: underline;
        }

        .divider {
            margin: 25px 0;
            text-align: center;
            position: relative;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255, 255, 255, 0.3);
        }

        .divider span {
            background: linear-gradient(135deg, #2d89ef, #1e3c72);
            padding: 0 20px;
            color: rgba(255, 255, 255, 0.8);
        }

        .dashboard {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .dashboard-title {
            font-size: 24px;
            font-weight: bold;
            color: #ffcc00;
        }

        .logout-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid #ffcc00;
            border-radius: 8px;
            color: #ffcc00;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #ffcc00;
            color: #000;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
        }

        .card-title {
            font-size: 20px;
            font-weight: bold;
            color: #ffcc00;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-content {
            color: rgba(255, 255, 255, 0.9);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #ffcc00;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.8;
            margin-top: 5px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ffcc00, #ffd700);
            color: #000;
        }

        .btn-primary:hover {
            background: linear-gradient(45deg, #e6b800, #ffcc00);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .trip-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .trip-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border-left: 4px solid #ffcc00;
        }

        .trip-info {
            flex: 1;
        }

        .trip-route {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .trip-details {
            font-size: 14px;
            opacity: 0.8;
        }

        .trip-value {
            font-size: 18px;
            font-weight: bold;
            color: #ffcc00;
        }

        .message {
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 500;
            animation: slideIn 0.3s ease;
        }

        .message.success {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
            color: #4CAF50;
        }

        .message.error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
            color: #f44336;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @media (max-width: 768px) {
            .dashboard-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="loginScreen" class="auth-container">
        <div class="logo">üöï</div>
        <h1 class="auth-title">TaxiControl Pro</h1>
        <p class="auth-subtitle">Sistema completo de gest√£o para taxistas profissionais</p>
        
        <div id="loginMessage" class="message" style="display: none; padding: 15px; margin-bottom: 20px; border-radius: 10px; text-align: center; font-weight: 500;"></div>
        
        <form id="loginForm">
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" required>
            </div>
            <div class="form-group">
                <label for="password">Senha:</label>
                <input type="password" id="password" required>
            </div>
            <div class="form-group" style="display: flex; align-items: center; gap: 10px; margin-bottom: 25px;">
                <input type="checkbox" id="keepConnected" style="width: auto; margin: 0;">
                <label for="keepConnected" style="margin: 0; cursor: pointer; font-size: 14px;">Manter conectado</label>
            </div>
            <button type="submit" class="auth-button">Entrar</button>
        </form>

        <div class="divider">
            <span>ou</span>
        </div>

        <div class="auth-links">
            <a onclick="showRegister()">Criar conta</a>
        </div>
    </div>

    <!-- Tela de Cadastro -->
    <div id="registerScreen" class="auth-container" style="display: none;">
        <div class="logo">üöï</div>
        <h1 class="auth-title">Criar Conta</h1>
        <p class="auth-subtitle">Junte-se aos milhares de taxistas que j√° usam o TaxiControl Pro</p>
        
        <div id="registerMessage" class="message" style="display: none; padding: 15px; margin-bottom: 20px; border-radius: 10px; text-align: center; font-weight: 500;"></div>
        
        <form id="registerForm">
            <div class="form-group">
                <label for="regName">Nome completo:</label>
                <input type="text" id="regName" required>
            </div>
            <div class="form-group">
                <label for="regEmail">Email:</label>
                <input type="email" id="regEmail" required>
            </div>
            <div class="form-group">
                <label for="regPhone">Celular:</label>
                <input type="tel" id="regPhone" placeholder="(11) 99999-9999" required>
            </div>
            <div class="form-group">
                <label for="regPlate">Placa:</label>
                <input type="text" id="regPlate" placeholder="ABC-1234" maxlength="8" style="text-transform: uppercase;" required>
            </div>
            <div class="form-group">
                <label for="regPassword">Senha:</label>
                <input type="password" id="regPassword" required>
            </div>
            <div class="form-group">
                <label for="regConfirmPassword">Confirmar senha:</label>
                <input type="password" id="regConfirmPassword" required>
            </div>
            <button type="submit" class="auth-button">Criar Conta</button>
        </form>

        <div class="auth-links">
            <a onclick="showLogin()">J√° tenho uma conta</a>
        </div>
    </div>



    <!-- Dashboard Principal -->
    <div id="dashboard" class="dashboard">
        <div class="dashboard-header">
            <div>
                <h1 class="dashboard-title">üöï TaxiControl Pro</h1>
                <p>Bem-vindo, <span id="userName">Taxista</span>!</p>
            </div>
            <button class="logout-btn" onclick="logout()">Sair</button>
        </div>

        <!-- Estat√≠sticas R√°pidas -->
        <div class="dashboard-card">
            <h2 class="card-title">üìä Resumo do Dia</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="todayTrips">0</div>
                    <div class="stat-label">Corridas Hoje</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="todayEarnings">R$ 0,00</div>
                    <div class="stat-label">Ganhos Hoje</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="todayFuel">R$ 0,00</div>
                    <div class="stat-label">Gastos Hoje</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="todayProfit">R$ 0,00</div>
                    <div class="stat-label">Lucro L√≠quido</div>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Registrar Nova Corrida -->
            <div class="dashboard-card">
                <h2 class="card-title">üöó Nova Corrida</h2>
                <div class="card-content">
                    <form id="tripForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Origem:</label>
                                <input type="text" id="tripOrigin" required>
                            </div>
                            <div class="form-group">
                                <label>Destino:</label>
                                <input type="text" id="tripDestination" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Valor (R$):</label>
                                <input type="number" id="tripValue" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label>Data:</label>
                                <input type="date" id="tripDate" style="width: 100%; padding: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.9); color: #333;" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Forma de Pagamento:</label>
                                <select id="paymentMethod" style="width: 100%; padding: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.9); color: #333;">
                                    <option value="dinheiro">üíµ Dinheiro</option>
                                    <option value="cartao">üí≥ Cart√£o</option>
                                    <option value="pix">üì± PIX</option>
                                    <option value="fiado">üìù Fiado</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Observa√ß√£o:</label>
                            <textarea id="tripObservation" placeholder="Ex: Cliente frequente, bagagem extra, etc." style="width: 100%; padding: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.9); color: #333; resize: vertical; min-height: 80px; font-family: inherit;"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Registrar Corrida</button>
                    </form>
                </div>
            </div>

            <!-- Controle de Gastos Profissionais -->
            <div class="dashboard-card">
                <h2 class="card-title">üí∞ Gastos Profissionais</h2>
                <div class="card-content">
                    <form id="expensesForm">
                        <div class="form-group">
                            <label>Tipo de Gasto:</label>
                            <select id="expenseType" style="width: 100%; padding: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.9); color: #333;">
                                <option value="combustivel">‚õΩ Combust√≠vel</option>
                                <option value="lavagem">üöø Lavagem do Carro</option>
                                <option value="manutencao">üîß Manuten√ß√£o</option>
                                <option value="seguro">üõ°Ô∏è Seguro</option>
                                <option value="licenciamento">üìÑ Licenciamento</option>
                                <option value="multa">üö´ Multa</option>
                                <option value="estacionamento">üÖøÔ∏è Estacionamento</option>
                                <option value="pedagio">üõ£Ô∏è Ped√°gio</option>
                                <option value="alimentacao">üçΩÔ∏è Alimenta√ß√£o</option>
                                <option value="outros">üìù Outros</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Valor (R$):</label>
                                <input type="number" id="expenseValue" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label>Data:</label>
                                <input type="date" id="expenseDate" style="width: 100%; padding: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.9); color: #333;" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Descri√ß√£o:</label>
                            <input type="text" id="expenseDescription" placeholder="Descreva o gasto (obrigat√≥rio para 'Outros')" style="width: 100%; padding: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.9); color: #333;">
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Registrar Gasto</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Lista de Corridas Recentes -->
        <div class="dashboard-card">
            <h2 class="card-title">üìã Corridas Recentes</h2>
            <div class="card-content">
                <div class="trip-list" id="tripsList">
                    <p style="text-align: center; opacity: 0.7; padding: 20px;">Nenhuma corrida registrada hoje</p>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="showReportModal()">üìÑ Gerar Relat√≥rio</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Gerar Relat√≥rio -->
    <div id="reportModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; backdrop-filter: blur(5px);">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(255,255,255,0.1); backdrop-filter: blur(15px); border-radius: 20px; padding: 30px; max-width: 500px; width: 90%; border: 1px solid rgba(255,255,255,0.2);">
            <h2 style="color: #ffcc00; margin-bottom: 20px; text-align: center;">üìÑ Gerar Relat√≥rio</h2>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #ffcc00; font-weight: 500;">Per√≠odo:</label>
                <select id="reportPeriod" style="width: 100%; padding: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.9); color: #333; margin-bottom: 15px;">
                    <option value="today">üìÖ Hoje</option>
                    <option value="week">üìÖ Esta Semana</option>
                    <option value="month">üìÖ Este M√™s</option>
                    <option value="custom">üìÖ Per√≠odo Personalizado</option>
                </select>
            </div>
            
            <div id="customDateRange" style="display: none; margin-bottom: 20px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; color: #ffcc00; font-weight: 500;">Data Inicial:</label>
                        <input type="date" id="reportStartDate" style="width: 100%; padding: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.9); color: #333;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; color: #ffcc00; font-weight: 500;">Data Final:</label>
                        <input type="date" id="reportEndDate" style="width: 100%; padding: 15px; border-radius: 10px; border: none; background: rgba(255,255,255,0.9); color: #333;">
                    </div>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button onclick="generateReportPage()" class="btn btn-primary">üìÑ Gerar Relat√≥rio</button>
                <button onclick="closeReportModal()" class="btn btn-secondary">‚ùå Cancelar</button>
            </div>
        </div>
    </div>



    <script>
        // Dados do usu√°rio e corridas
        let currentUser = null;
        let trips = JSON.parse(localStorage.getItem('taxiTrips')) || [];
        let expenses = JSON.parse(localStorage.getItem('taxiExpenses')) || [];



        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            // Definir data atual no campo de data
            const now = new Date();
            const dateString = now.toISOString().split('T')[0];
            document.getElementById('tripDate').value = dateString;
            document.getElementById('expenseDate').value = dateString;

            // Verificar se h√° usu√°rio logado (manter conectado)
            const savedUser = localStorage.getItem('currentUser');
            const keepConnected = localStorage.getItem('keepConnected') === 'true';
            
            if (savedUser && keepConnected) {
                currentUser = JSON.parse(savedUser);
                showDashboard();
            }
        });



        // Fun√ß√£o para mostrar mensagens
        function showMessage(message, type = 'success') {
            const messageDiv = document.getElementById('loginMessage');
            messageDiv.textContent = message;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
            
            // Esconder mensagem ap√≥s 4 segundos
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 4000);
        }

        // Fun√ß√£o para mostrar mensagens de cadastro
        function showRegisterMessage(message, type = 'success') {
            const messageDiv = document.getElementById('registerMessage');
            messageDiv.textContent = message;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
            
            // Esconder mensagem ap√≥s 4 segundos
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 4000);
        }

        // Fun√ß√£o para mostrar notifica√ß√µes no dashboard
        function showNotification(message, type = 'info') {
            // Criar elemento de notifica√ß√£o se n√£o existir
            let notificationDiv = document.getElementById('dashboardNotification');
            if (!notificationDiv) {
                notificationDiv = document.createElement('div');
                notificationDiv.id = 'dashboardNotification';
                notificationDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    max-width: 400px;
                    padding: 15px 20px;
                    border-radius: 10px;
                    font-weight: 500;
                    z-index: 1000;
                    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
                    backdrop-filter: blur(10px);
                    animation: slideInRight 0.3s ease;
                `;
                document.body.appendChild(notificationDiv);
            }
            
            // Definir cores baseadas no tipo
            let backgroundColor, borderColor, textColor;
            switch(type) {
                case 'success':
                    backgroundColor = 'rgba(76, 175, 80, 0.9)';
                    borderColor = '#4CAF50';
                    textColor = '#fff';
                    break;
                case 'warning':
                    backgroundColor = 'rgba(255, 193, 7, 0.9)';
                    borderColor = '#FFC107';
                    textColor = '#000';
                    break;
                case 'error':
                    backgroundColor = 'rgba(244, 67, 54, 0.9)';
                    borderColor = '#f44336';
                    textColor = '#fff';
                    break;
                default: // info
                    backgroundColor = 'rgba(33, 150, 243, 0.9)';
                    borderColor = '#2196F3';
                    textColor = '#fff';
            }
            
            notificationDiv.style.background = backgroundColor;
            notificationDiv.style.border = `2px solid ${borderColor}`;
            notificationDiv.style.color = textColor;
            notificationDiv.textContent = message;
            notificationDiv.style.display = 'block';
            
            // Esconder notifica√ß√£o ap√≥s 5 segundos
            setTimeout(() => {
                notificationDiv.style.display = 'none';
            }, 5000);
        }



        // Fun√ß√µes de autentica√ß√£o
        function showLogin() {
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('registerScreen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'none';
        }

        function showRegister() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('registerScreen').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
        }

        function showDashboard() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('registerScreen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            
            if (currentUser) {
                document.getElementById('userName').textContent = currentUser.name;
            }
            
            updateStats();
            displayTrips();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            localStorage.removeItem('keepConnected');
            showLogin();
        }

        // Manipuladores de formul√°rio
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const keepConnected = document.getElementById('keepConnected').checked;
            
            // Valida√ß√µes b√°sicas
            if (!email || !password) {
                showMessage('Por favor, preencha todos os campos!', 'error');
                return;
            }
            
            if (!email.includes('@')) {
                showMessage('Por favor, insira um email v√°lido!', 'error');
                return;
            }
            
            // Simula√ß√£o de login (em produ√ß√£o, isso seria validado no servidor)
            const users = JSON.parse(localStorage.getItem('taxiUsers')) || [];
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                // Salvar prefer√™ncia de manter conectado
                if (keepConnected) {
                    localStorage.setItem('keepConnected', 'true');
                } else {
                    localStorage.removeItem('keepConnected');
                }
                
                showMessage('Login efetuado com sucesso! Redirecionando...', 'success');
                
                // Aguardar um pouco antes de redirecionar para mostrar a mensagem
                setTimeout(() => {
                    showDashboard();
                }, 1500);
            } else {
                showMessage('Email ou senha incorretos! Verifique seus dados e tente novamente.', 'error');
            }
        });

        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const phone = document.getElementById('regPhone').value;
            const plate = document.getElementById('regPlate').value;
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('regConfirmPassword').value;
            
            // Valida√ß√µes
            if (!name || !email || !phone || !plate || !password || !confirmPassword) {
                showRegisterMessage('Por favor, preencha todos os campos!', 'error');
                return;
            }
            
            if (!email.includes('@')) {
                showRegisterMessage('Por favor, insira um email v√°lido!', 'error');
                return;
            }
            
            if (password.length < 6) {
                showRegisterMessage('A senha deve ter pelo menos 6 caracteres!', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showRegisterMessage('As senhas n√£o coincidem!', 'error');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('taxiUsers')) || [];
            
            if (users.find(u => u.email === email)) {
                showRegisterMessage('Este email j√° est√° cadastrado!', 'error');
                return;
            }
            
            if (users.find(u => u.plate === plate.toUpperCase())) {
                showRegisterMessage('Esta placa j√° est√° cadastrada!', 'error');
                return;
            }
            
            const newUser = { 
                name, 
                email, 
                phone, 
                plate: plate.toUpperCase(), 
                password, 
                id: Date.now() 
            };
            users.push(newUser);
            localStorage.setItem('taxiUsers', JSON.stringify(users));
            
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            
            showRegisterMessage('Cadastro efetuado com sucesso! Redirecionando...', 'success');
            
            // Aguardar um pouco antes de redirecionar para mostrar a mensagem
            setTimeout(() => {
                showDashboard();
            }, 2000);
        });



        document.getElementById('tripForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const trip = {
                id: Date.now(),
                userId: currentUser.id,
                origin: document.getElementById('tripOrigin').value,
                destination: document.getElementById('tripDestination').value,
                value: parseFloat(document.getElementById('tripValue').value),
                paymentMethod: document.getElementById('paymentMethod').value,
                date: document.getElementById('tripDate').value,
                observation: document.getElementById('tripObservation').value
            };
            
            trips.push(trip);
            localStorage.setItem('taxiTrips', JSON.stringify(trips));
            
            // Limpar formul√°rio
            document.getElementById('tripForm').reset();
            const now = new Date();
            document.getElementById('tripDate').value = now.toISOString().split('T')[0];
            
            updateStats();
            displayTrips();
            
            alert('Corrida registrada com sucesso!');
        });



        document.getElementById('expensesForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const expenseType = document.getElementById('expenseType').value;
            const description = document.getElementById('expenseDescription').value;
            
            // Validar se descri√ß√£o √© obrigat√≥ria para "outros"
            if (expenseType === 'outros' && !description.trim()) {
                alert('Por favor, descreva o gasto quando selecionar "Outros"!');
                return;
            }
            
            const expense = {
                id: Date.now(),
                userId: currentUser.id,
                type: expenseType,
                value: parseFloat(document.getElementById('expenseValue').value),
                date: document.getElementById('expenseDate').value,
                description: description || ''
            };
            
            expenses.push(expense);
            localStorage.setItem('taxiExpenses', JSON.stringify(expenses));
            
            // Limpar formul√°rio
            document.getElementById('expensesForm').reset();
            const now = new Date();
            document.getElementById('expenseDate').value = now.toISOString().split('T')[0];
            
            updateStats();
            
            alert('Gasto registrado com sucesso!');
        });

        // Fun√ß√µes de estat√≠sticas
        function updateStats() {
            if (!currentUser) return;
            
            const today = new Date().toISOString().split('T')[0];
            const todayTrips = trips.filter(t => t.userId === currentUser.id && t.date === today);
            const todayExpenses = expenses.filter(e => e.userId === currentUser.id && e.date === today);
            
            const totalTrips = todayTrips.length;
            const totalEarnings = todayTrips.reduce((sum, trip) => sum + trip.value, 0);
            const totalExpensesCost = todayExpenses.reduce((sum, expense) => sum + expense.value, 0);
            const totalProfit = totalEarnings - totalExpensesCost;
            
            document.getElementById('todayTrips').textContent = totalTrips;
            document.getElementById('todayEarnings').textContent = `R$ ${totalEarnings.toFixed(2)}`;
            document.getElementById('todayFuel').textContent = `R$ ${totalExpensesCost.toFixed(2)}`;
            document.getElementById('todayProfit').textContent = `R$ ${totalProfit.toFixed(2)}`;
        }

        function displayTrips() {
            if (!currentUser) return;
            
            const today = new Date().toISOString().split('T')[0];
            const todayTrips = trips.filter(t => t.userId === currentUser.id && t.date === today);
            const tripsList = document.getElementById('tripsList');
            
            if (todayTrips.length === 0) {
                tripsList.innerHTML = '<p style="text-align: center; opacity: 0.7; padding: 20px;">Nenhuma corrida registrada hoje</p>';
                return;
            }
            
            tripsList.innerHTML = todayTrips.map(trip => `
                <div class="trip-item">
                    <div class="trip-info">
                        <div class="trip-route">${trip.origin} ‚Üí ${trip.destination}</div>
                        <div class="trip-details">
                            ${trip.date} ‚Ä¢ ${trip.paymentMethod}${trip.observation ? ' ‚Ä¢ ' + trip.observation : ''}
                        </div>
                    </div>
                    <div class="trip-value">R$ ${trip.value.toFixed(2)}</div>
                </div>
            `).join('');
        }

        // Fun√ß√µes de relat√≥rio e exporta√ß√£o
        function showReportModal() {
            document.getElementById('reportModal').style.display = 'block';
            
            // Configurar datas padr√£o
            const today = new Date();
            document.getElementById('reportStartDate').value = today.toISOString().split('T')[0];
            document.getElementById('reportEndDate').value = today.toISOString().split('T')[0];
        }

        function closeReportModal() {
            document.getElementById('reportModal').style.display = 'none';
        }



        // Mostrar/esconder campos de data personalizada
        document.addEventListener('DOMContentLoaded', function() {
            // Para o modal de relat√≥rio
            document.getElementById('reportPeriod').addEventListener('change', function() {
                const customRange = document.getElementById('customDateRange');
                if (this.value === 'custom') {
                    customRange.style.display = 'block';
                } else {
                    customRange.style.display = 'none';
                }
            });


        });

        function getDateRange(period, startDateId, endDateId) {
            const today = new Date();
            let startDate, endDate;

            switch(period) {
                case 'today':
                    startDate = endDate = today.toISOString().split('T')[0];
                    break;
                case 'week':
                    const weekStart = new Date(today);
                    weekStart.setDate(today.getDate() - today.getDay());
                    startDate = weekStart.toISOString().split('T')[0];
                    endDate = today.toISOString().split('T')[0];
                    break;
                case 'month':
                    const monthStart = new Date(today.getFullYear(), today.getMonth(), 1);
                    startDate = monthStart.toISOString().split('T')[0];
                    endDate = today.toISOString().split('T')[0];
                    break;
                case 'custom':
                    startDate = document.getElementById(startDateId).value;
                    endDate = document.getElementById(endDateId).value;
                    break;
                case 'all':
                    return { startDate: null, endDate: null };
                default:
                    startDate = endDate = today.toISOString().split('T')[0];
            }

            return { startDate, endDate };
        }

        function filterDataByPeriod(data, startDate, endDate) {
            if (!startDate || !endDate) return data;
            
            return data.filter(item => {
                const itemDate = item.date;
                return itemDate >= startDate && itemDate <= endDate;
            });
        }

        function generateReportPage() {
            if (!currentUser) return;
            
            const period = document.getElementById('reportPeriod').value;
            
            // Validar per√≠odo personalizado
            if (period === 'custom') {
                const startDate = document.getElementById('reportStartDate').value;
                const endDate = document.getElementById('reportEndDate').value;
                
                if (!startDate || !endDate) {
                    showNotification('üìÖ Por favor, selecione as datas inicial e final!', 'warning');
                    return;
                }
                
                if (startDate > endDate) {
                    showNotification('üìÖ A data inicial n√£o pode ser maior que a data final!', 'warning');
                    return;
                }
            }
            
            const { startDate, endDate } = getDateRange(period, 'reportStartDate', 'reportEndDate');
            
            let userTrips = trips.filter(t => t.userId === currentUser.id);
            let userExpenses = expenses.filter(e => e.userId === currentUser.id);
            
            // Filtrar por per√≠odo se n√£o for "all"
            if (startDate && endDate) {
                userTrips = filterDataByPeriod(userTrips, startDate, endDate);
                userExpenses = filterDataByPeriod(userExpenses, startDate, endDate);
            }
            
            if (userTrips.length === 0 && userExpenses.length === 0) {
                showNotification('üìã Nenhum dado encontrado para o per√≠odo selecionado!', 'info');
                return;
            }
            
            // Gerar HTML do relat√≥rio
            const reportHTML = generateReportHTML(userTrips, userExpenses, period, startDate, endDate);
            
            // Abrir nova janela com o relat√≥rio
            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(reportHTML);
            reportWindow.document.close();
            
            closeReportModal();
            showNotification('üìÑ Relat√≥rio gerado com sucesso! Nova aba aberta.', 'success');
        }

        function generateReportHTML(userTrips, userExpenses, period, startDate, endDate) {
            const totalTrips = userTrips.length;
            const totalEarnings = userTrips.reduce((sum, trip) => sum + trip.value, 0);
            const totalExpensesCost = userExpenses.reduce((sum, expense) => sum + expense.value, 0);
            const totalProfit = totalEarnings - totalExpensesCost;
            
            let periodText = '';
            switch(period) {
                case 'today': periodText = 'Hoje'; break;
                case 'week': periodText = 'Esta Semana'; break;
                case 'month': periodText = 'Este M√™s'; break;
                case 'custom': periodText = `${new Date(startDate).toLocaleDateString('pt-BR')} a ${new Date(endDate).toLocaleDateString('pt-BR')}`; break;
            }
            
            const expenseTypeNames = {
                'combustivel': 'Combust√≠vel',
                'lavagem': 'Lavagem do Carro',
                'manutencao': 'Manuten√ß√£o',
                'seguro': 'Seguro',
                'licenciamento': 'Licenciamento',
                'multa': 'Multa',
                'estacionamento': 'Estacionamento',
                'pedagio': 'Ped√°gio',
                'alimentacao': 'Alimenta√ß√£o',
                'outros': 'Outros'
            };
            
            const paymentMethodNames = {
                'dinheiro': 'Dinheiro',
                'cartao': 'Cart√£o',
                'pix': 'PIX',
                'fiado': 'Fiado'
            };
            
            return `
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rio TaxiControl Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .report-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .report-header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid #2d89ef;
            padding-bottom: 20px;
        }
        
        .report-title {
            font-size: 28px;
            color: #2d89ef;
            margin-bottom: 10px;
        }
        
        .report-subtitle {
            font-size: 16px;
            color: #666;
        }
        
        .report-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .info-label {
            font-weight: bold;
            color: #555;
        }
        
        .info-value {
            color: #333;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .summary-card {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }
        
        .summary-card.earnings {
            background: #d4edda;
            border-color: #28a745;
        }
        
        .summary-card.expenses {
            background: #f8d7da;
            border-color: #dc3545;
        }
        
        .summary-card.profit {
            background: #d1ecf1;
            border-color: #17a2b8;
        }
        
        .summary-card.trips {
            background: #fff3cd;
            border-color: #ffc107;
        }
        
        .summary-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 14px;
            color: #666;
        }
        
        .section-title {
            font-size: 20px;
            color: #2d89ef;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        
        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .data-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #555;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        .value-positive {
            color: #28a745;
            font-weight: bold;
        }
        
        .value-negative {
            color: #dc3545;
            font-weight: bold;
        }
        
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2d89ef;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(45, 137, 239, 0.3);
            transition: all 0.3s ease;
        }
        
        .print-button:hover {
            background: #1e3c72;
            transform: translateY(-2px);
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .print-button {
                display: none;
            }
            
            .report-container {
                box-shadow: none;
                padding: 20px;
            }
        }
        
        @media (max-width: 768px) {
            .report-info {
                grid-template-columns: 1fr;
            }
            
            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .print-button {
                position: static;
                width: 100%;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <button class="print-button" onclick="window.print()">üñ®Ô∏è Imprimir Relat√≥rio</button>
    
    <div class="report-container">
        <div class="report-header">
            <h1 class="report-title">üöï TaxiControl Pro</h1>
            <p class="report-subtitle">Relat√≥rio Detalhado de Atividades</p>
        </div>
        
        <div class="report-info">
            <div>
                <div class="info-item">
                    <span class="info-label">Taxista:</span>
                    <span class="info-value">${currentUser.name}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Placa:</span>
                    <span class="info-value">${currentUser.plate}</span>
                </div>
            </div>
            <div>
                <div class="info-item">
                    <span class="info-label">Per√≠odo:</span>
                    <span class="info-value">${periodText}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Gerado em:</span>
                    <span class="info-value">${new Date().toLocaleDateString('pt-BR')} √†s ${new Date().toLocaleTimeString('pt-BR')}</span>
                </div>
            </div>
        </div>
        
        <div class="summary-grid">
            <div class="summary-card trips">
                <div class="summary-value">${totalTrips}</div>
                <div class="summary-label">Total de Corridas</div>
            </div>
            <div class="summary-card earnings">
                <div class="summary-value">R$ ${totalEarnings.toFixed(2)}</div>
                <div class="summary-label">Ganhos Totais</div>
            </div>
            <div class="summary-card expenses">
                <div class="summary-value">R$ ${totalExpensesCost.toFixed(2)}</div>
                <div class="summary-label">Gastos Totais</div>
            </div>
            <div class="summary-card profit">
                <div class="summary-value ${totalProfit >= 0 ? 'value-positive' : 'value-negative'}">R$ ${totalProfit.toFixed(2)}</div>
                <div class="summary-label">Lucro L√≠quido</div>
            </div>
        </div>
        
        ${userTrips.length > 0 ? `
        <h2 class="section-title">üìã Detalhamento das Corridas</h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Origem ‚Üí Destino</th>
                    <th>Pagamento</th>
                    <th>Valor</th>
                </tr>
            </thead>
            <tbody>
                ${userTrips.map(trip => `
                <tr>
                    <td>${new Date(trip.date).toLocaleDateString('pt-BR')}</td>
                    <td>${trip.origin} ‚Üí ${trip.destination}${trip.observation ? '<br><small style="color: #666;">Obs: ' + trip.observation + '</small>' : ''}</td>
                    <td>${paymentMethodNames[trip.paymentMethod] || trip.paymentMethod}</td>
                    <td class="value-positive">R$ ${trip.value.toFixed(2)}</td>
                </tr>
                `).join('')}
            </tbody>
        </table>
        ` : ''}
        
        ${userExpenses.length > 0 ? `
        <h2 class="section-title">üí∞ Detalhamento dos Gastos</h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Tipo</th>
                    <th>Descri√ß√£o</th>
                    <th>Valor</th>
                </tr>
            </thead>
            <tbody>
                ${userExpenses.map(expense => `
                <tr>
                    <td>${new Date(expense.date).toLocaleDateString('pt-BR')}</td>
                    <td>${expenseTypeNames[expense.type] || expense.type}</td>
                    <td>${expense.description || '-'}</td>
                    <td class="value-negative">R$ ${expense.value.toFixed(2)}</td>
                </tr>
                `).join('')}
            </tbody>
        </table>
        ` : ''}
        
        <div style="margin-top: 40px; padding-top: 20px; border-top: 2px solid #e9ecef; text-align: center; color: #666; font-size: 14px;">
            <p>Relat√≥rio gerado pelo TaxiControl Pro - Sistema de Gest√£o para Taxistas</p>
            <p>¬© ${new Date().getFullYear()} - Todos os direitos reservados</p>
        </div>
    </div>
</body>
</html>
            `;
        }




    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9700fe26e56bcac7',t:'MTc1NTM0Nzk0OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
